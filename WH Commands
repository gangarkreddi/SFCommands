create warehouse default_wh; 
select * from "SNOWFLAKE_SAMPLE_DATA"."TPCDS_SF10TCL"."CALL_CENTER";

CREATE WAREHOUSE SingleCluster_WH WITH WAREHOUSE_SIZE = 'XSMALL' AUTO_SUSPEND = 30 
AUTO_RESUME = TRUE MIN_CLUSTER_COUNT = 1 MAX_CLUSTER_COUNT = 1 SCALING_POLICY = 'STANDARD';


alter warehouse SINGLECLUSTER_WH SUSPEND;

alter warehouse SINGLECLUSTER_WH RESUME;


ALTER WAREHOUSE "SINGLECLUSTER_WH" SET WAREHOUSE_SIZE = 'MEDIUM' AUTO_SUSPEND = 30 AUTO_RESUME = TRUE 
MIN_CLUSTER_COUNT = 1 MAX_CLUSTER_COUNT = 5 SCALING_POLICY = 'STANDARD' COMMENT = '';


CREATE WAREHOUSE "REPORTING_WH" WAREHOUSE_SIZE = 'MEDIUM' AUTO_SUSPEND = 300 AUTO_RESUME = TRUE 
MIN_CLUSTER_COUNT = 1 MAX_CLUSTER_COUNT = 7 SCALING_POLICY = 'STANDARD' COMMENT = '';

ALTER WAREHOUSE "REPORTING_WH" SET WAREHOUSE_SIZE = 'MEDIUM' AUTO_SUSPEND = 300 AUTO_RESUME = TRUE 
MIN_CLUSTER_COUNT = 1 MAX_CLUSTER_COUNT = 10 SCALING_POLICY = 'STANDARD' COMMENT = '';

ALTER WAREHOUSE "REPORTING_WH" SET WAREHOUSE_SIZE = 'MEDIUM' AUTO_SUSPEND = 300 AUTO_RESUME = TRUE 
MIN_CLUSTER_COUNT = 3 MAX_CLUSTER_COUNT = 10 SCALING_POLICY = 'STANDARD' COMMENT = '';


CREATE WAREHOUSE ETL_TEST_WH
WAREHOUSE_SIZE = XSMALL
MAX_CLUSTER_COUNT = 3
MIN_CLUSTER_COUNT = 1
SCALING_POLICY = ECONOMY
AUTO_SUSPEND = 300 -- suspend after 5 minutes (300 seconds) of inactivity
AUTO_RESUME = TRUE
INITIALLY_SUSPENDED = TRUE
COMMENT = 'Virtual warehouse for ETL workloads. Auto scales between 1 and on the workload';



ALTER WAREHOUSE "REPORTING_WH" SET WAREHOUSE_SIZE = 'MEDIUM' AUTO_SUSPEND = 300 AUTO_RESUME = TRUE 
MIN_CLUSTER_COUNT = 4 MAX_CLUSTER_COUNT = 4 SCALING_POLICY = 'STANDARD' COMMENT = '';


CREATE WAREHOUSE MULTICLUSTER_WH
WAREHOUSE_SIZE = XSMALL
MAX_CLUSTER_COUNT = 3
MIN_CLUSTER_COUNT = 1
SCALING_POLICY = ECONOMY
AUTO_SUSPEND = 60 -- suspend after 1 minute (60 seconds) of inactivity
AUTO_RESUME = TRUE
INITIALLY_SUSPENDED = TRUE
COMMENT = 'Virtual warehouse for ETL workloads. Auto scales
between 1 and 3 clusters depending on the workload';

--Rename a warehouse
alter warehouse if exists SS_ETL_WH rename to SINGLECLUSTER_WH;
--Resume a warehouse and then change the size of the warehouse
alter warehouse ETL_WH resume;
alter warehouse my_wh set warehouse_size=medium;
